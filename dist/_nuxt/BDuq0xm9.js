import{d as v,r as h,D as y,o as b,g as C,t as l,v as i,x as o,z as d,A as p,y as _,O as T,B as E,U as A,N as S}from"./BPmhSm-Y.js";import{_ as N}from"./BXyX1x7l.js";import{a as r}from"./upsvKRUO.js";const w=async()=>(await r.get("https://www.snacks2school.com/api/csrf-token/",{withCredentials:!0})).data.csrfToken;async function R(){try{const t=await w();return(await r.get("https://www.snacks2school.com/api/check-auth-status/",{headers:{"Content-Type":"application/json","X-CSRFToken":t||""},withCredentials:!0})).data.isAuthenticated?(console.log("User is authenticated"),!0):(console.log("User is not authenticated"),!1)}catch(t){return console.error("Error checking auth status:",t),!1}}async function U(){var t;try{const e=await w();return(await r.get("https://www.snacks2school.com/api/current-user-data/",{headers:{"Content-Type":"application/json","X-CSRFToken":e||""},withCredentials:!0})).data}catch(e){return r.isAxiosError(e)?console.error("Error retrieving user data:",(t=e.response)==null?void 0:t.data):console.error("Error retrieving user data:",e),null}}async function H(){var t;try{const e=await w();return(await r.get("https://www.snacks2school.com/api/children/",{headers:{"Content-Type":"application/json","X-CSRFToken":e||""},withCredentials:!0})).data}catch(e){return r.isAxiosError(e)?console.error("Error retrieving children data:",(t=e.response)==null?void 0:t.data):console.error("Error retrieving children data:",e),null}}const j={class:"bg-background/75 backdrop-blur-[8px] border-b-[0.5px] border-gray border-opacity-100 sticky top-0 z-50"},B={class:"mx-auto !px-4 sm:px-6 lg:px-8 max-w-7xl flex items-center justify-between gap-3 h-16"},F={class:"flex items-center gap-1.5"},D={key:0},V={class:"flex items-center space-x-2"},X={class:"relative"},z={key:0,class:"absolute right-0 mt-2 w-36 bg-white border border-gray-200 !rounded-md shadow-lg flex flex-col gap-1"},M={key:1,class:"flex items-center gap-3"},q=v({__name:"Navbar",setup(t){const e=h(!1),a=h(null),g=y(),c=h(!1),k=()=>{c.value=!c.value},x=async()=>(await r.get("https://www.snacks2school.com/api/csrf-token/",{withCredentials:!0})).data.csrfToken,m=async()=>{try{const n=await x();(await r.post("https://www.snacks2school.com/api/logout/",{headers:{"X-CSRFToken":n},withCredentials:!0})).status===200&&(localStorage.removeItem("token"),e.value=!1,a.value=null,g.push("/login"))}catch(n){console.error("Logout failed:",n)}};return b(async()=>{e.value=await R(),a.value=await U()}),(n,s)=>{var f;const u=C("router-link");return l(),i("header",j,[o("div",B,[o("div",F,[d(u,{to:"/",class:"flex-shrink-0 font-bold text-xl text-gray-900 dark:text-white flex items-end gap-1.5","aria-label":"Home"},{default:p(()=>s[0]||(s[0]=[o("img",{src:N,alt:"star",class:"h-28 w-28"},null,-1)])),_:1})]),a.value?(l(),i("div",D,[o("div",V,[o("span",null,"Ehi "+_((f=a.value)==null?void 0:f.first_name),1),o("div",X,[o("button",{onClick:k,class:"flex items-center space-x-1"},[(l(),i("svg",{class:T([{"rotate-180":c.value,"transition-transform":!0},"w-5 h-5 text-gray-700"]),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},s[1]||(s[1]=[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))]),c.value?(l(),i("div",z,[d(u,{to:"/profile",class:"block w-full text-left !px-4 !pt-2 !text-gray-700 hover:bg-gray-100"},{default:p(()=>s[2]||(s[2]=[E("Il mio profilo")])),_:1}),o("button",{onClick:A(m,["prevent"]),class:"block w-full text-left !px-4 !pb-2 !text-gray-700 hover:bg-gray-100"}," Esci ")])):S("",!0)])])])):(l(),i("div",M,[d(u,{to:"/login"},{default:p(()=>s[3]||(s[3]=[o("button",{class:"btn bg-[#ffa500] !px-4 !py-2 !rounded-md text-black"}," Accedi ",-1)])),_:1}),d(u,{to:"/group-choice"},{default:p(()=>s[4]||(s[4]=[o("button",{class:"btn bg-black text-white !px-4 !py-2 !rounded-md"}," Registrati ",-1)])),_:1})]))])])}}});export{q as _,H as a,R as c,U as g};
