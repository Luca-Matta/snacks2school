import{d as x,r as h,D as v,o as b,g as y,t as l,v as i,x as r,z as d,A as p,y as _,O as C,B as T,S as A,N as E}from"./Lh55aVSo.js";import{_ as N}from"./inWKtfgP.js";import{a as s}from"./upsvKRUO.js";async function S(){try{const t=localStorage.getItem("authToken");return t?(await s.get("https://www.snacks2school.com/api/check-auth-status/",{headers:{"Content-Type":"application/json",Authorization:`Token ${t}`},withCredentials:!0})).data.isAuthenticated?(console.log("User is authenticated"),!0):(console.log("User is not authenticated"),!1):(console.log("No auth token found."),!1)}catch(t){return console.error("Error checking auth status:",t),!1}}async function z(){var t;try{const e=localStorage.getItem("authToken");return e?(await s.get("https://www.snacks2school.com/api/current-user-data/",{headers:{"Content-Type":"application/json",Authorization:`Token ${e}`},withCredentials:!0})).data:(console.log("No auth token found."),null)}catch(e){return s.isAxiosError(e)?console.error("Error retrieving user data:",(t=e.response)==null?void 0:t.data):console.error("Error retrieving user data:",e),null}}async function O(){var t;try{const e=localStorage.getItem("authToken");return e?(await s.get("https://www.snacks2school.com/api/children/",{headers:{"Content-Type":"application/json",Authorization:`Token ${e}`},withCredentials:!0})).data:(console.error("No auth token found."),null)}catch(e){return s.isAxiosError(e)?console.error("Error retrieving children data:",(t=e.response)==null?void 0:t.data):console.error("Error retrieving children data:",e),null}}const j={class:"bg-background/75 backdrop-blur-[8px] border-b-[0.5px] border-gray border-opacity-100 sticky top-0 z-50 pt-12"},B={class:"mx-auto !px-4 sm:px-6 lg:px-8 max-w-7xl flex items-center justify-between gap-3 h-16"},I={class:"flex items-center gap-1.5"},U={key:0},D={class:"flex items-center space-x-2"},V={class:"relative"},M={key:0,class:"absolute right-0 mt-2 w-36 bg-white border border-gray-200 !rounded-md shadow-lg flex flex-col gap-1"},R={key:1,class:"flex items-center gap-3"},H=x({__name:"Navbar",setup(t){const e=h(!1),a=h(null),f=v(),c=h(!1),w=()=>{c.value=!c.value},k=async()=>(await s.get("https://www.snacks2school.com/api/csrf-token/",{withCredentials:!0})).data.csrfToken,m=async()=>{try{const n=await k();(await s.post("https://www.snacks2school.com/api/logout/",{headers:{"X-CSRFToken":n},withCredentials:!0})).status===200&&(localStorage.removeItem("token"),e.value=!1,a.value=null,f.push("/login"))}catch(n){console.error("Logout failed:",n)}};return b(async()=>{e.value=await S(),a.value=await z()}),(n,o)=>{var g;const u=y("router-link");return l(),i("header",j,[r("div",B,[r("div",I,[d(u,{to:"/",class:"flex-shrink-0 font-bold text-xl text-gray-900 dark:text-white flex items-end gap-1.5","aria-label":"Home"},{default:p(()=>o[0]||(o[0]=[r("img",{src:N,alt:"star",class:"h-28 w-28"},null,-1)])),_:1})]),a.value?(l(),i("div",U,[r("div",D,[r("span",null,"Ehi "+_((g=a.value)==null?void 0:g.first_name),1),r("div",V,[r("button",{onClick:w,class:"flex items-center space-x-1"},[(l(),i("svg",{class:C([{"rotate-180":c.value,"transition-transform":!0},"w-5 h-5 text-gray-700"]),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},o[1]||(o[1]=[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))]),c.value?(l(),i("div",M,[d(u,{to:"/profile",class:"block w-full text-left !px-4 !pt-2 !text-gray-700 hover:bg-gray-100"},{default:p(()=>o[2]||(o[2]=[T("Il mio profilo")])),_:1}),r("button",{onClick:A(m,["prevent"]),class:"block w-full text-left !px-4 !pb-2 !text-gray-700 hover:bg-gray-100"}," Esci ")])):E("",!0)])])])):(l(),i("div",R,[d(u,{to:"/login"},{default:p(()=>o[3]||(o[3]=[r("button",{class:"btn bg-[#ffa500] !px-4 !py-2 !rounded-md text-black"}," Accedi ",-1)])),_:1}),d(u,{to:"/group-choice"},{default:p(()=>o[4]||(o[4]=[r("button",{class:"btn bg-black text-white !px-4 !py-2 !rounded-md"}," Registrati ",-1)])),_:1})]))])])}}});export{H as _,O as a,S as c,z as g};
