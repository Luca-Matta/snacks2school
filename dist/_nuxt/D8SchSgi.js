import{d as _,r as l,o as E,t as r,v as a,x as t,B as m,U as M,V as d,W as C,Y as b,P as v,Q as x,y as g,N as y}from"./zBMnQkMZ.js";import{c as j}from"./BC9YvzMU.js";import{a as u}from"./upsvKRUO.js";const D={key:0,class:"fixed inset-0 flex justify-center items-center z-30 !px-4 md:px-0",style:{"backdrop-filter":"blur(50px)"}},F={class:"bg-white p-8 !rounded-3xl outline outline-4 outline-white outline-offset-4 shadow-card w-full max-w-96 max-h-[500px] overflow-y-auto"},L={class:"mb-4"},q={class:"mb-4"},z={class:"mb-3"},R=["value"],$={key:0,class:"mb-3"},Q=["value"],W={key:1,class:"mb-3"},X=["value"],J=_({__name:"AddChild",props:{isAddChildVisible:{type:Boolean}},emits:["close"],setup(Y,{emit:V}){const S=l(!1),c=l(""),p=l("");l("");const h=l([]),i=l(null),w=l([]),n=l(null),f=l(""),k=l([]),A=V,P=async()=>{try{const o=await u.get("http://localhost:8000/api/provinces/");h.value=o.data}catch(o){console.error("Error fetching provinces:",o)}},N=async()=>{if(i.value)try{const o=await u.get(`http://localhost:8000/api/province/schools/?province=${i.value}`);w.value=o.data}catch(o){console.error("Error fetching schools:",o)}},U=async()=>{if(n.value)try{const o=await u.get(`http://localhost:8000/api/school/classes/?school=${n.value}`);k.value=o.data}catch(o){console.error("Error fetching classes:",o)}},B=async()=>(await u.get("http://localhost:8000/api/csrf-token/",{withCredentials:!0})).data.csrfToken,T=async()=>{const o=await B();try{const e=await u.post("http://localhost:8000/api/child/create/",{first_name:c.value,last_name:p.value,associated_schools:[n.value],school_class:f.value},{headers:{"X-CSRFToken":o},withCredentials:!0});e.status>=200&&e.status<300&&(A("close"),window.location.reload())}catch(e){console.error("Error creating child:",e)}};return E(async()=>{S.value=await j(),P()}),(o,e)=>o.isAddChildVisible?(r(),a("div",D,[t("div",F,[e[14]||(e[14]=t("h2",{class:"text-xl text-center font-bold mb-2"},"Aggiungi un figlio",-1)),e[15]||(e[15]=t("div",{class:"text-center text-xs mb-4"},[m(" Abbiamo implementato una nuova funzionalità!"),t("br"),m(" Puoi gestire più figli in un unico account!"),t("br"),m(" Per effettuare un ordine devi inserire almeno un figlio. ")],-1)),t("form",{onSubmit:M(T,["prevent"])},[t("div",L,[e[5]||(e[5]=t("label",{for:"first_name",class:"block text-xs mb-1"},"Nome *",-1)),d(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>c.value=s),type:"text",id:"first_name",class:"w-full bg-[#f5f5f5] border border-[#e0e0e0]",style:{"border-radius":"5px",padding:"7px"},required:""},null,512),[[C,c.value]])]),t("div",q,[e[6]||(e[6]=t("label",{for:"last_name",class:"block text-xs mb-1"},"Cognome *",-1)),d(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>p.value=s),type:"text",id:"last_name",class:"w-full bg-[#f5f5f5] border border-[#e0e0e0]",style:{"border-radius":"5px",padding:"7px"},required:""},null,512),[[C,p.value]])]),t("div",z,[e[8]||(e[8]=t("label",{class:"block text-xs mb-1"},"Provincia della scuola *",-1)),d(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>i.value=s),id:"selectedProvince",name:"selectedProvince",class:"w-full bg-[#f5f5f5] border border-[1.5px] border-[#ffa500] !rounded !px-2 !py-1 cursor-pointer",style:{"border-radius":"5px",padding:"7px"},onChange:N},[e[7]||(e[7]=t("option",{value:"",disabled:""},null,-1)),(r(!0),a(v,null,x(h.value,s=>(r(),a("option",{key:s.id,value:s.id},g(s.name),9,R))),128))],544),[[b,i.value]])]),i.value?(r(),a("div",$,[e[10]||(e[10]=t("label",{class:"block text-xs mb-1"},"Scuola *",-1)),d(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>n.value=s),id:"associatedSchool",name:"associatedSchool",class:"w-full bg-[#f5f5f5] border border-[1.5px] border-[#ffa500] !rounded !px-2 !py-1 cursor-pointer",onChange:U},[e[9]||(e[9]=t("option",{value:"",disabled:""},null,-1)),(r(!0),a(v,null,x(w.value,s=>(r(),a("option",{key:s.id,value:s.id},g(s.name),9,Q))),128))],544),[[b,n.value]])])):y("",!0),n.value?(r(),a("div",W,[e[12]||(e[12]=t("label",{class:"block text-xs mb-1"},"Classe *",-1)),d(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>f.value=s),id:"schoolClass",name:"schoolClass",class:"w-full bg-[#f5f5f5] border border-[1.5px] border-[#ffa500] !rounded !px-2 !py-1 cursor-pointer",style:{"border-radius":"5px",padding:"7px"}},[e[11]||(e[11]=t("option",{value:"",disabled:""},null,-1)),(r(!0),a(v,null,x(k.value,s=>(r(),a("option",{key:s.id,value:s.id},g(s.name),9,X))),128))],512),[[b,f.value]])])):y("",!0),e[13]||(e[13]=t("div",{class:"flex justify-end"},[t("button",{type:"submit",class:"flex justify-center mx-auto btn bg-[#ffa500] uppercase text-black text-xs shadow-button !py-3 !px-6 !rounded-lg mt-4"}," Aggiungi ")],-1))],32)])])):y("",!0)}}),K=""+new URL("referrer.DLACM6a7.png",import.meta.url).href;export{J as _,K as a};
